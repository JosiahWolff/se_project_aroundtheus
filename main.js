!function(){"use strict";class e{constructor(e){this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close-button"),this._handleEscapeClose=this._handleEscapeClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscapeClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscapeClose)}_handleEscapeClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close-button"))&&this.close()}))}}const t=document.querySelector("#profile-edit-modal"),s=document.querySelector("#add-card-modal"),r=s.querySelector("#add-card-form"),i=(document.querySelector("#profile-title"),document.querySelector("#profile-subtitle"),document.querySelector("#profile-title-input")),o=document.querySelector("#profile-subtitle-input"),n=(t.querySelector("#modal-form"),document.querySelector("#card-template").content.firstElementChild,document.querySelector("#cards"),r.querySelector("#card-title-input"),r.querySelector("#card-url-input"),document.querySelector("#modal-preview-image"),document.querySelector("#modal-caption"),document.querySelector("#cardPreviewModal")),a=document.querySelector("#profile-edit-button"),l=(t.querySelector("#modal-close"),document.querySelector("#profile__button")),c=(s.querySelector("#modal-card-close"),n.querySelector("#card-preview-close-button"),document.querySelector("#avatar-edit-button")),d={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};class u{constructor(e,t,s,r,i){this._cardData=e,this._name=e.name,this._link=e.link,this.id=e._id,this.isLiked=e.isLiked,this._cardSelector=t,this._handleLikeClick=s,this._handleDeleteClick=r,this._handleImageClick=i}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".cards__card").cloneNode(!0)}getView(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector("#heart-image"),this._deleteButton=this._cardElement.querySelector("#trash-image"),this._cardElement.querySelector(".cards__title").textContent=this._name,this._cardImage=this._cardElement.querySelector("#card-image"),this._cardImage.setAttribute("src",this._link),this._cardImage.setAttribute("alt",this._name),this._setEventListeners(),this._renderLikes(),this._cardElement}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._likeButton.classList.toggle("heart_active")})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._link,this._name)}))}updateLikeStatus(e){this.isLiked=e,this._renderLikes()}_renderLikes(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}removeCard(){this._cardElement.remove(),this._cardElement=null}getId(){return this.id}}class h{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}resetValidation(){this._inputEls.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this.toggleButtonState()}}class _ extends e{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._saveButton=this._popupForm.querySelector(".modal__save-button"),this._saveButtonText=this._saveButton.textContent}_getInputValues(){const e=this._popupForm.querySelectorAll(".modal__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){this._popupForm.reset(),super.close()}setLoading(e){this._saveButton.textContent=e?"Saving...":this._saveButtonText}}class m{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}class p{constructor(e,t,s){this._name=document.querySelector(e),this._description=document.querySelector(t),this._userAvatar=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,description:this._description.textContent}}setUserInfo(e){this._name.textContent=e.name,this._description.textContent=e.about}setUserAvatar(e){this._userAvatar.src=e}}const v=new h(d,document.querySelector("#modal-form")),S=new h(d,document.querySelector("#add-card-form"));function E(e){return new u(e,"#card-template",q,I,((e,t)=>{C.open(e,t)})).getView()}new p(".profile__title",".profile__subtitle");const f=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}updateUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((e=>this._checkResponse(e)))}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>this._checkResponse(e)))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then((e=>this._checkResponse(e)))}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((e=>this._checkResponse(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this._checkResponse(e)))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then((e=>this._checkResponse(e)))}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>this._checkResponse(e)))}loadPageContent(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"0f915c02-d173-4ea0-aefb-dc32641e7138","Content-Type":"application/json"}});let y;f.loadPageContent().then((e=>{let[t,s]=e;b.setUserAvatar(s.avatar),b.setUserInfo({name:s.name,about:s.about,id:s._id}),y=new m({items:t,renderer:e=>{y.addItem(E(e))}},".cards"),y.renderItems()})).catch((e=>{console.error(e)}));const b=new p(".profile__title",".profile__subtitle",".profile__image"),L=new _("#add-card-modal",(function(e){L.setLoading(!0);const t={name:e.title,link:e.url};f.addCard(t).then((e=>{y.addItem(E(e)),L.close()})).catch((e=>{console.error(e)})).finally((()=>L.setLoading(!1,"Create")))}));L.setEventListeners(),l.addEventListener("click",(()=>{S.resetValidation(),L.open()}));const g=new _("#profile-edit-modal",(function(e){g.setLoading(!0),f.updateUserInfo(e.title,e.subtitle).then((e=>{b.setUserInfo(e),g.close()})).catch((e=>{console.error(e)})).finally((()=>g.setLoading(!1,"Save")))}));g.setEventListeners(),a.addEventListener("click",(()=>{const e=b.getUserInfo();i.value=e.name,o.value=e.description,v.resetValidation(),g.open()}));const k=new _("#avatar-image-modal",(function(e){k.setLoading(!0),f.updateAvatar(e.avatar).then((e=>{b.setUserAvatar(e.avatar),k.close()})).catch((e=>{console.error(e)})).finally((()=>{k.setLoading(!1,"Save")}))}));k.setEventListeners(),c.addEventListener("click",(()=>{w["edit-avatar-form"].resetValidation(),k.open()}));const C=new class extends e{constructor(e){super(e),this._image=this._popupElement.querySelector("#modal-preview-image"),this._caption=this._popupElement.querySelector("#modal-caption")}open(e,t){super.open(),this._image.src=e,this._image.alt=t,this._caption.textContent=t}}("#cardPreviewModal");function q(e){e.isLiked?f.unlikeCard(e.getId()).then((t=>{e.updateLikeStatus(t.isLiked)})).catch(console.error):f.likeCard(e.getId()).then((t=>{e.updateLikeStatus(t.isLiked)})).catch((e=>{console.error(e)}))}C.setEventListeners();const B=new class extends e{constructor(e){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._saveButton=this._popupForm.querySelector(".modal__save-button"),this._saveButtonText=this._saveButton.textContent}setLoading(e){this._saveButton.textContent=e?"Deleting...":this._saveButtonText}setSubmitAction(e){this._handleFormSubmit=e}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()})),super.setEventListeners()}}("#delete-card-modal");function I(e){B.open(),B.setSubmitAction((()=>{B.setLoading(!0),f.deleteCard(e.id).then((()=>{B.close(),e.removeCard()})).catch((e=>{console.error(e)})).finally((()=>{B.setLoading(!1,"Yes")}))})),B.open()}B.setEventListeners();const w={};(e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{const s=new h(e,t),r=t.getAttribute("name");w[r]=s,s.enableValidation()}))})(d)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUt3RyxZQUFZMUMsWUFEZm9ELEVBQzZCLGNBRUFsSCxLQUFLeUcsZUFFeEMsQ0FFQXdGLGVBQUFBLENBQWdCQyxHQUNkbE0sS0FBS3VHLGtCQUFvQjJGLENBQzNCLENBRUFsTCxpQkFBQUEsR0FDRWhCLEtBQUtzRyxXQUFXNUYsaUJBQWlCLFVBQVdPLElBQzFDQSxFQUFNaUYsaUJBQ05sRyxLQUFLdUcsbUJBQW1CLElBRTFCRixNQUFNckYsbUJBQ1IsR0hzTDhDLHNCQUdoRCxTQUFTMEIsRUFBa0I4SCxHQUN6QndCLEVBQWN6TCxPQUNkeUwsRUFBY0MsaUJBQWdCLEtBQzVCRCxFQUFjL0UsWUFBVyxHQUN6QjhCLEVBQ0cwQixXQUFXRCxFQUFLdkgsSUFDaEI0RyxNQUFLLEtBQ0ptQyxFQUFjckwsUUFDZDZKLEVBQUtuRyxZQUFZLElBRWxCK0csT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQUVuQkksU0FBUSxLQUNQTyxFQUFjL0UsWUFBVyxFQUFPLE1BQU0sR0FDdEMsSUFFTitFLEVBQWN6TCxNQUNoQixDQXBCQXlMLEVBQWNoTCxvQkF3QmQsTUFBTTJLLEVBQWlCLENBQUMsRUFDRTVKLEtBQ1BvSyxNQUFNQyxLQUFLbE0sU0FBUzhFLGlCQUFpQmpELEVBQU9DLGVBQ3BEOEQsU0FBU3VHLElBQ2hCLE1BQU1DLEVBQVksSUFBSS9ILEVBQWN4QyxFQUFRc0ssR0FDdENFLEVBQVdGLEVBQVlHLGFBQWEsUUFDMUNiLEVBQWVZLEdBQVlELEVBQzNCQSxFQUFVckcsa0JBQWtCLEdBQzVCLEVBRUpBLENBQWlCbEUsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZUNsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NhcGVDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2ZW50LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBFbGVtZW50IHx8XHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZS1idXR0b25cIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG4vKiBFbGVtZW50cyAqL1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybUVsZW1lbnQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xyXG5cclxuLy9wcm9maWxlXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGVcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlU3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtc3VidGl0bGVcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVTdWJ0aXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLXN1YnRpdGxlLWlucHV0XCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1mb3JtXCIpO1xyXG5cclxuLy9jYXJkXHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPVxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5leHBvcnQgY29uc3QgY2FyZFdyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRzXCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZFRpdGxlSW5wdXQgPVxyXG4gIGFkZENhcmRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGl0bGUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkVXJsSW5wdXQgPSBhZGRDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXVybC1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRQcmV2aWV3SW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLXByZXZpZXctaW1hZ2VcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkQ2FwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtY2FwdGlvblwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRQcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRQcmV2aWV3TW9kYWxcIik7XHJcblxyXG4vL2J1dHRvbnNcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRDbG9zZUJ1dHRvbiA9XHJcbiAgcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNsb3NlXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24gPVxyXG4gIGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNhcmQtY2xvc2VcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkUHJldmlld0Nsb3NlQnV0dG9uID0gY2FyZFByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI2NhcmQtcHJldmlldy1jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgZWRpdEF2YXRhck9wZW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI2F2YXRhci1lZGl0LWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBjYXJkRGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUxpa2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5fY2FyZERhdGEgPSBjYXJkRGF0YTtcclxuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XHJcbiAgICB0aGlzLmlkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5pc0xpa2VkID0gY2FyZERhdGEuaXNMaWtlZDtcclxuXHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNoZWFydC1pbWFnZVwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdHJhc2gtaW1hZ2VcIik7XHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX190aXRsZVwiKTtcclxuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX2xpbmspO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCB0aGlzLl9uYW1lKTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vbGlrZS1idXR0b25cclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiaGVhcnRfYWN0aXZlXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy9kZWxldGUtYnV0dG9uXHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL2NhcmRfaW1hZ2VcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9saW5rLCB0aGlzLl9uYW1lKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZVN0YXR1cyhpc0xpa2VkKSB7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMaWtlcygpIHtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5pZDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtKSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm07XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIC8vcHJpdmF0ZVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IHtcclxuICAgICAgcmV0dXJuIGlucHV0RWwudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vcHVibGljXHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvblRleHQgPSB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRFbGVtZW50cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIGNvbnN0IHZhbHVlcyA9IHt9O1xyXG4gICAgaW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB2YWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIC8vdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3NhdmVCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBzZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGRhdGEpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGRhdGEpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgdXNlckluZm8gPSB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgICByZXR1cm4gdXNlckluZm87XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvblwiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7XHJcbiAgaW5pdGlhbENhcmRzLFxyXG4gIGNvbmZpZyxcclxuICBwcm9maWxlVGl0bGVJbnB1dCxcclxuICBwcm9maWxlU3VidGl0bGVJbnB1dCxcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBhZGROZXdDYXJkQnV0dG9uLFxyXG4gIGVkaXRBdmF0YXJPcGVuQnV0dG9uLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudC5qc1wiO1xyXG5cclxuLy8gVmFyaWFibGVzXHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWcsXHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1mb3JtXCIpXHJcbik7XHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uZmlnLFxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKVxyXG4pO1xyXG5cclxuY29uc3QgcHJvZmlsZVVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX3RpdGxlXCIsIFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpO1xyXG5cclxuLy9DcmVhdGUgJiBSZW5kZXIgQ2FyZFxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgZGF0YSxcclxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIGhhbmRsZUxpa2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgKGxpbmssIG5hbWUpID0+IHtcclxuICAgICAgY2FyZFByZXZpZXdNb2RhbC5vcGVuKGxpbmssIG5hbWUpO1xyXG4gICAgfVxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xyXG59XHJcblxyXG4vLyBBcGkgVXNlciBJbmZvL0luaXRpYWwgQ2FyZHNcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjBmOTE1YzAyLWQxNzMtNGVhMC1hZWZiLWRjMzI2NDFlNzEzOFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5hcGlcclxuICAubG9hZFBhZ2VDb250ZW50KClcclxuICAudGhlbigoW2NhcmRzLCB1c2VyRGF0YV0pID0+IHtcclxuICAgIG5ld1VzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuICAgIG5ld1VzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogdXNlckRhdGFbXCJuYW1lXCJdLFxyXG4gICAgICBhYm91dDogdXNlckRhdGFbXCJhYm91dFwiXSxcclxuICAgICAgaWQ6IHVzZXJEYXRhW1wiX2lkXCJdLFxyXG4gICAgfSk7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChjYXJkRGF0YSkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIFwiLmNhcmRzXCJcclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICB9KTtcclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxuXHJcbmNvbnN0IG5ld1VzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxyXG4gIFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxuICBcIi5wcm9maWxlX19pbWFnZVwiXHJcbik7XHJcblxyXG4vLyBBZGQgQ2FyZFxyXG5cclxuY29uc3QgYWRkQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmQtbW9kYWxcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XHJcbmFkZENhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChkYXRhKSB7XHJcbiAgYWRkQ2FyZE1vZGFsLnNldExvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIGNvbnN0IGNvcnJlY3RlZERhdGEgPSB7XHJcbiAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgbGluazogZGF0YS51cmwsXHJcbiAgfTtcclxuXHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZChjb3JyZWN0ZWREYXRhKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQocmVzKSk7XHJcbiAgICAgIGFkZENhcmRNb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiBhZGRDYXJkTW9kYWwuc2V0TG9hZGluZyhmYWxzZSwgXCJDcmVhdGVcIikpO1xyXG59XHJcblxyXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYWRkQ2FyZE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG4vL0VkaXQgUHJvZmlsZVxyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XHJcbik7XHJcbnByb2ZpbGVFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGRhdGEpIHtcclxuICBwcm9maWxlRWRpdE1vZGFsLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlVXNlckluZm8oZGF0YS50aXRsZSwgZGF0YS5zdWJ0aXRsZSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgbmV3VXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcclxuICAgICAgcHJvZmlsZUVkaXRNb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiBwcm9maWxlRWRpdE1vZGFsLnNldExvYWRpbmcoZmFsc2UsIFwiU2F2ZVwiKSk7XHJcbn1cclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgZGF0YSA9IG5ld1VzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBkYXRhLm5hbWU7XHJcbiAgcHJvZmlsZVN1YnRpdGxlSW5wdXQudmFsdWUgPSBkYXRhLmRlc2NyaXB0aW9uO1xyXG5cclxuICBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcblxyXG4gIHByb2ZpbGVFZGl0TW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbi8vVXBkYXRlIEF2YXRhclxyXG5cclxuY29uc3QgdXBkYXRlQXZhdGFyRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI2F2YXRhci1pbWFnZS1tb2RhbFwiLFxyXG4gIGhhbmRsZUF2YXRhckZvcm1TdWJtaXRcclxuKTtcclxudXBkYXRlQXZhdGFyRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChkYXRhKSB7XHJcbiAgdXBkYXRlQXZhdGFyRm9ybS5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhcihkYXRhLmF2YXRhcilcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgbmV3VXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcclxuICAgICAgdXBkYXRlQXZhdGFyRm9ybS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHVwZGF0ZUF2YXRhckZvcm0uc2V0TG9hZGluZyhmYWxzZSwgXCJTYXZlXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmVkaXRBdmF0YXJPcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJlZGl0LWF2YXRhci1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIHVwZGF0ZUF2YXRhckZvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbi8vSW1hZ2UgUG9wdXAvUHJldmlld1xyXG5cclxuY29uc3QgY2FyZFByZXZpZXdNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNjYXJkUHJldmlld01vZGFsXCIpO1xyXG5jYXJkUHJldmlld01vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL0NhcmQgTGlrZVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGl0ZW0pIHtcclxuICBpZiAoIWl0ZW0uaXNMaWtlZCkge1xyXG4gICAgYXBpXHJcbiAgICAgIC5saWtlQ2FyZChpdGVtLmdldElkKCkpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpdGVtLnVwZGF0ZUxpa2VTdGF0dXMocmVzLmlzTGlrZWQpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaVxyXG4gICAgICAudW5saWtlQ2FyZChpdGVtLmdldElkKCkpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpdGVtLnVwZGF0ZUxpa2VTdGF0dXMocmVzLmlzTGlrZWQpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG4vL0NhcmQgRGVsZXRlXHJcblxyXG5jb25zdCBjb25maXJtRGVsZXRlID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcclxuY29uZmlybURlbGV0ZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZCkge1xyXG4gIGNvbmZpcm1EZWxldGUub3BlbigpO1xyXG4gIGNvbmZpcm1EZWxldGUuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcclxuICAgIGNvbmZpcm1EZWxldGUuc2V0TG9hZGluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmlkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY29uZmlybURlbGV0ZS5jbG9zZSgpO1xyXG4gICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1EZWxldGUuc2V0TG9hZGluZyhmYWxzZSwgXCJZZXNcIik7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG4gIGNvbmZpcm1EZWxldGUub3BlbigpO1xyXG59XHJcblxyXG4vL0Zvcm0gVmFsaWRhdG9yXHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZyk7XHJcbiIsImltcG9ydCB7IGluaXRpYWxDYXJkcyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudC5qc1wiO1xyXG4vL2ltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlVXNlckluZm8odGl0bGUsIHN1YnRpdGxlKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdGl0bGUsXHJcbiAgICAgICAgYWJvdXQ6IHN1YnRpdGxlLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcih1cmwpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiB1cmwsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKGNhcmQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGNhcmQubmFtZSxcclxuICAgICAgICBsaW5rOiBjYXJkLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICBsb2FkUGFnZUNvbnRlbnQoKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1wcmV2aWV3LWltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNhcHRpb25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGxpbmssIHRpdGxlKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gdGl0bGU7XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gdGl0bGU7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvblRleHQgPSB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0TG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zYXZlQnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBhY3Rpb247XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJQb3B1cCIsImNvbnN0cnVjdG9yIiwicG9wdXBTZWxlY3RvciIsInRoaXMiLCJfcG9wdXBFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2Nsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY2FwZUNsb3NlIiwiYmluZCIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2UiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJldmVudCIsInRhcmdldCIsImNvbnRhaW5zIiwicHJvZmlsZUVkaXRNb2RhbCIsImFkZENhcmRNb2RhbCIsImFkZENhcmRGb3JtRWxlbWVudCIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZVN1YnRpdGxlSW5wdXQiLCJjYXJkUHJldmlld01vZGFsIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGROZXdDYXJkQnV0dG9uIiwiZWRpdEF2YXRhck9wZW5CdXR0b24iLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkNhcmQiLCJjYXJkRGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUxpa2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlSW1hZ2VDbGljayIsIl9jYXJkRGF0YSIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsImlkIiwiX2lkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJnZXRWaWV3IiwiX2NhcmRFbGVtZW50IiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwidGV4dENvbnRlbnQiLCJfY2FyZEltYWdlIiwic2V0QXR0cmlidXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX3JlbmRlckxpa2VzIiwidG9nZ2xlIiwidXBkYXRlTGlrZVN0YXR1cyIsInJlbW92ZUNhcmQiLCJnZXRJZCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0RWxzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlRWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImV2ZXJ5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsImZvckVhY2giLCJyZXNldFZhbGlkYXRpb24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3NhdmVCdXR0b24iLCJfc2F2ZUJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dEVsZW1lbnRzIiwidmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsImUiLCJyZXNldCIsInNldExvYWRpbmciLCJpc0xvYWRpbmciLCJTZWN0aW9uIiwiX3JlZiIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImFkZEl0ZW0iLCJkYXRhIiwicHJlcGVuZCIsIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX2Rlc2NyaXB0aW9uIiwiX3VzZXJBdmF0YXIiLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJhYm91dCIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJzcmMiLCJwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsImNyZWF0ZUNhcmQiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJ1cGRhdGVVc2VySW5mbyIsInRpdGxlIiwic3VidGl0bGUiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZUF2YXRhciIsInVybCIsImdldEluaXRpYWxDYXJkcyIsImFkZENhcmQiLCJjYXJkIiwiZGVsZXRlQ2FyZCIsImxpa2VDYXJkIiwiY2FyZElkIiwidW5saWtlQ2FyZCIsImxvYWRQYWdlQ29udGVudCIsImFsbCIsImF1dGhvcml6YXRpb24iLCJjYXJkU2VjdGlvbiIsImNhcmRzIiwidXNlckRhdGEiLCJuZXdVc2VySW5mbyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiY29ycmVjdGVkRGF0YSIsImZpbmFsbHkiLCJ1cGRhdGVBdmF0YXJGb3JtIiwiZm9ybVZhbGlkYXRvcnMiLCJfaW1hZ2UiLCJfY2FwdGlvbiIsImFsdCIsIml0ZW0iLCJjb25maXJtRGVsZXRlIiwic2V0U3VibWl0QWN0aW9uIiwiYWN0aW9uIiwiQXJyYXkiLCJmcm9tIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=